<!DOCTYPE html>
<html>
<head>
	<title>ola</title>
</head>
<body onload="start()">

<select id="day_sel">
	
</select>

<img id="profile_pic">
<p id="nome_utilizador"></p>
<p id="sns_utilizador"></p>
<p id="subs_utilizador"></p>
<p id="centro_utilizador"></p>

<div id="texto">
	
</div>


<div id="internamentos">
</div>

<label for="male" title="nabo do caraças pa">Ola!</label>

<script>

function start() {
	dropdown_dias(report_text);
	set_profile(report_text);
	set_internamentos(report_text);
	set_informacao(report_text);
}



function harvest_first_report() {
//Receive JSON with data

//API to implement - send a string to be converted to JSON again


//Result of convertion


}

var report_text = {"user": {"nome": "Filipe Monteiro","sns" : "00000","sub_sistema": "nenhum","centro_saude": "braga"},"internamentos": [{"data": "2017-15","anot": [{"dia": "1","s" : "sssssss1","o" : "ooooooo1","a" : "aaaaaaa1","p": "ppppppp1"},{"dia": "2","s": "sssssss2","o": "ooo2","a" : "aaaaaaa2","p" : "ppppppp2"}]},{"data":"2017-20"}]};


let inter_atual = 0;


function texto_ola(){
for (var i = 0; i < report_text.internamentos.length; i++){
	var text_box_div = document.createElement('div');
	text_box_div.id = "text_box" + i;


	if (report_text.internamentos[i].anot != null){
		for (var j = 0; j < report_text.internamentos[i].anot.length; i++){
			var data_div = document.createElement('div');

			var dia = document.createElement('h3');
			dia.id = "dia " + report_text.internamentos[i].anot[j].dia;
			data_div.push(dia);


			var ss = document.createElement('p');
			ss.innerHTML = report_text.internamentos[i].anot[j].s;
			data_div.push(ss);
			
			if (report_text.internamentos[i].anot[j].o != " "){
				var oo = document.createElement('p');
				oo.innerHTML = report_text.internamentos[i].anot[j].o;
				data_div.push(oo);
			}
			if (report_text.internamentos[i].anot[j].a != " "){
				var aa = document.createElement('p');
				aa.innerHTML = report_text.internamentos[i].anot[j].a;
				data_div.push(aa);
			}
			if (report_text.internamentos[i].anot[j].p != " "){
				var pp = document.createElement('p');
				pp.innerHTML = report_text.internamentos[i].anot[j].p;
				data_div.push(pp);
			}
			 
			text_box_div.push(data_div);
		}

	}

}
}





function dropdown_dias(report_text) {
	for (var i = report_text.internamentos[inter_atual].anot.length-1; i >= 0; i--){
		console.log(i);
		var option = document.createElement('option');
		option.value = report_text.internamentos[inter_atual].anot[i].dia;
		if(i == report_text.internamentos[inter_atual].anot.length-1)
			option.selected = "selected";
		option.text = "Dia " + report_text.internamentos[inter_atual].anot[i].dia;
		document.getElementById('day_sel').options.add(option);
	}
}


function set_profile(report_text) {
	document.getElementById('nome_utilizador').innerHTML = "Utilizador: " + report_text.user.nome;
	document.getElementById('sns_utilizador').innerHTML = "Nº SNS: " + report_text.user.sns;
	document.getElementById('subs_utilizador').innerHTML = "Sub Sistema: " + report_text.user.sub_sistema;
	document.getElementById('centro_utilizador').innerHTML = "Centro de Saude: " + report_text.user.centro_saude;
	document.getElementById('profile_pic').src = "perfil.png";
}

function set_internamentos(report_text) {
	for (var i = report_text.internamentos.length-1; i >= 0; i--){
		var p = document.createElement('p');
		p.innerHTML = report_text.internamentos[i].data;

		document.getElementById('internamentos').append(p);
	}
}

function set_informacao(report_text) {
	// 0 porque existe apenas um internamento com dados
	var p;
	let dia = document.getElementById('day_sel').value;
	console.log("ENTREI");
	for (var i = 0; i < report_text.internamentos[0].anot.length; i++){
		console.log("BOI");
		if (report_text.internamentos[0].anot[i].dia == dia){
			console.log("Vaca");
			p = document.createElement('p');
			p.innerHTML = "S) <br>" + report_text.internamentos[0].anot[i].s + "</br>";
			console.log(p.innerHTML);
			document.getElementById('texto').append(p);


			if (report_text.internamentos[0].anot[i].o != " "){
				p = document.createElement('p');
				p.innerHTML = "O) <br>" + report_text.internamentos[0].anot[i].o + "</br>";
				console.log(p.innerHTML);
				document.getElementById('texto').append(p);
			}
			if (report_text.internamentos[0].anot[i].a != " "){
				p = document.createElement('p');
				p.innerHTML = "A) <br>" + report_text.internamentos[0].anot[i].a + "</br>";
				console.log(p.innerHTML);
				document.getElementById('texto').append(p);
			}
			if (report_text.internamentos[0].anot[i].p != " "){
				p = document.createElement('p');
				p.innerHTML = "P) <br>" + report_text.internamentos[0].anot[i].p + "</br>";
				console.log(p.innerHTML);
				document.getElementById('texto').append(p);
			}
		}
	}
}


</script>



</body>
</html>